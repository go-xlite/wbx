var D=window.location.pathname.split("/").filter((K)=>K),E=D.length>0?"/"+D[0]:"";document.getElementById("proxy-endpoint").textContent=`${E}/proxy/`;var j={total:0,successful:0,failed:0,lastStatus:"-"},f=document.getElementById("path-input"),k=document.getElementById("method-select"),q=document.getElementById("send-request-btn"),v=document.getElementById("clear-btn"),Y=document.getElementById("message-log"),Z=document.getElementById("response-headers"),N=document.getElementById("response-body");function C(){document.getElementById("total-requests").textContent=j.total,document.getElementById("successful-requests").textContent=j.successful,document.getElementById("failed-requests").textContent=j.failed,document.getElementById("last-status").textContent=j.lastStatus}function J(K,V="info"){let W=new Date().toLocaleTimeString(),w=document.createElement("div");w.className=`log-entry log-${V}`,w.innerHTML=`<span class="log-time">[${W}]</span>${K}`,Y.appendChild(w),Y.scrollTop=Y.scrollHeight}function R(){Y.innerHTML="",Z.innerHTML="<em>Response headers will appear here...</em>",N.innerHTML="<em>Response body will appear here...</em>",J("Logs cleared","info")}async function I(){let K=f.value.trim(),V=k.value,W=`${E}/proxy/${K}`;j.total++,C(),J(`Sending ${V} request to: ${W}`,"info");try{let w=Date.now(),F=await fetch(W,{method:V,headers:{Accept:"*/*"}}),G=Date.now()-w,_=F.status,$=F.statusText;j.lastStatus=`${_} ${$}`;let M={};F.headers.forEach((Q,A)=>{M[A]=Q});let O="<strong>Response Headers:</strong><br>";for(let[Q,A]of Object.entries(M))O+=`<div><strong>${Q}:</strong> ${A}</div>`;Z.innerHTML=O;let z=F.headers.get("content-type")||"",X;if(z.includes("application/json"))X=await F.json(),N.textContent=JSON.stringify(X,null,2);else if(z.includes("text/"))X=await F.text(),N.textContent=X;else{let Q=await F.blob();N.textContent=`Binary data (${Q.size} bytes)
Content-Type: ${z}`}if(F.ok)j.successful++,J(`✓ Success: ${_} ${$} (${G}ms)`,"success");else j.failed++,J(`✗ Error: ${_} ${$} (${G}ms)`,"error")}catch(w){j.failed++,j.lastStatus="Error",J(`✗ Request failed: ${w.message}`,"error"),Z.innerHTML='<em style="color: red;">Request failed</em>',N.textContent=`Error: ${w.message}`}C()}q.addEventListener("click",I);v.addEventListener("click",R);f.addEventListener("keypress",(K)=>{if(K.key==="Enter")I()});J("Proxy test console initialized","success");J("Target: https://file-drop.gtn.one:8080/xt21/","info");J(`Proxy endpoint: ${E}/proxy/`,"info");C();Z.innerHTML="<em>Response headers will appear here...</em>";N.innerHTML="<em>Response body will appear here...</em>";
